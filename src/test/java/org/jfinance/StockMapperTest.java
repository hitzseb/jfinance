package org.jfinance;

import org.jfinance.mapper.StockMapper;
import org.jfinance.model.Stock;
import org.jfinance.service.TimestampConverter;
import org.junit.jupiter.api.Test;

import java.io.IOException;

import static org.junit.jupiter.api.Assertions.*;

class StockMapperTest {

    @Test
    public void testBuildStockfromJson() {
        String optionsJsonStr = "{ \"optionChain\": { \"result\": [ " +
                "{ \"quote\": { \"symbol\": \"AAPL\", \"longName\": \"Apple Inc.\", " +
                "\"quoteType\": \"EQUITY\", \"currency\": \"USD\", \"exchangeTimezoneName\": \"America/New_York\", " +
                "\"regularMarketPrice\": 221.55, \"regularMarketChangePercent\": 0.0706917, " +
                "\"marketCap\": 3397269848064, \"bookValue\": 4.837, \"priceToBook\": 46.79347, " +
                "\"averageDailyVolume3Month\": 68492950, \"averageDailyVolume10Day\": 53271200, " +
                "\"fiftyTwoWeekLowChange\": 52.677597, \"fiftyTwoWeekLowChangePercent\": 0.32104826, " +
                "\"fiftyTwoWeekRange\": \"164.08 - 237.23\", \"fiftyTwoWeekHighChange\": -20.472397, " +
                "\"fiftyTwoWeekHighChangePercent\": -0.086297676, \"fiftyTwoWeekLow\": 164.08,  \"fiftyTwoWeekHigh\": 237.23," +
                "\"trailingPE\": 34.455677, \"forwardPE\": 30.349316, \"epsTrailingTwelveMonths\": 7.3, " +
                "\"epsCurrentYear\": 6.6, \"epsForward\": 7.3, \"priceEpsCurrentYear\": 34.293938, " +
                "\"dividendDate\": 1715817600, \"trailingAnnualDividendRate\": 6.43, " +
                "\"trailingAnnualDividendYield\": 0.0043582874, \"earningsTimestamp\": 1714681800, " +
                "\"sharesOutstanding\": 15334099968 } } ] } }";
        String searchJsonStr = "{ \"quotes\": [ { \"sector\": \"Technology\", " +
                "\"industry\": \"Consumer Electronics\", \"exchDisp\": \"NASDAQ\" } ] }";

        String quoteJson = "{\"status\":200,\"statusText\":\"OK\",\"headers\":{},\"body\":\"{\\\"quoteSummary\\\":{\\\"result\\\":[{\\\"recommendationTrend\\\":{\\\"trend\\\":[{\\\"period\\\":\\\"0m\\\",\\\"strongBuy\\\":11,\\\"buy\\\":21,\\\"hold\\\":6,\\\"sell\\\":0,\\\"strongSell\\\":0},{\\\"period\\\":\\\"-1m\\\",\\\"strongBuy\\\":12,\\\"buy\\\":19,\\\"hold\\\":12,\\\"sell\\\":1,\\\"strongSell\\\":0},{\\\"period\\\":\\\"-2m\\\",\\\"strongBuy\\\":10,\\\"buy\\\":19,\\\"hold\\\":13,\\\"sell\\\":1,\\\"strongSell\\\":0},{\\\"period\\\":\\\"-3m\\\",\\\"strongBuy\\\":10,\\\"buy\\\":24,\\\"hold\\\":7,\\\"sell\\\":1,\\\"strongSell\\\":0}],\\\"maxAge\\\":86400},\\\"equityPerformance\\\":{\\\"maxAge\\\":1,\\\"benchmark\\\":{\\\"symbol\\\":\\\"^GSPC\\\",\\\"shortName\\\":\\\"S&P 500\\\"},\\\"performanceOverview\\\":{\\\"asOfDate\\\":{\\\"raw\\\":1722211200,\\\"fmt\\\":\\\"2024-07-29\\\"},\\\"fiveDaysReturn\\\":{\\\"raw\\\":-0.025299162,\\\"fmt\\\":\\\"-2.53%\\\"},\\\"oneMonthReturn\\\":{\\\"raw\\\":0.03643534,\\\"fmt\\\":\\\"3.64%\\\"},\\\"threeMonthReturn\\\":{\\\"raw\\\":0.29114053,\\\"fmt\\\":\\\"29.11%\\\"},\\\"sixMonthReturn\\\":{\\\"raw\\\":0.13745463,\\\"fmt\\\":\\\"13.75%\\\"},\\\"ytdReturnPct\\\":{\\\"raw\\\":0.13680476,\\\"fmt\\\":\\\"13.68%\\\"},\\\"oneYearTotalReturn\\\":{\\\"raw\\\":0.12063175,\\\"fmt\\\":\\\"12.06%\\\"},\\\"twoYearTotalReturn\\\":{\\\"raw\\\":0.40301046,\\\"fmt\\\":\\\"40.30%\\\"},\\\"threeYearTotalReturn\\\":{\\\"raw\\\":0.5314178,\\\"fmt\\\":\\\"53.14%\\\"},\\\"fiveYearTotalReturn\\\":{\\\"raw\\\":3.3552248,\\\"fmt\\\":\\\"335.52%\\\"},\\\"tenYearTotalReturn\\\":{\\\"raw\\\":8.969276,\\\"fmt\\\":\\\"896.93%\\\"},\\\"maxReturn\\\":{\\\"raw\\\":1699.798,\\\"fmt\\\":\\\"169,979.80%\\\"}},\\\"performanceOverviewBenchmark\\\":{\\\"asOfDate\\\":{\\\"raw\\\":1722211200,\\\"fmt\\\":\\\"2024-07-29\\\"},\\\"fiveDaysReturn\\\":{\\\"raw\\\":-0.017838415,\\\"fmt\\\":\\\"-1.78%\\\"},\\\"oneMonthReturn\\\":{\\\"raw\\\":8.552219E-4,\\\"fmt\\\":\\\"0.09%\\\"},\\\"threeMonthReturn\\\":{\\\"raw\\\":0.071606435,\\\"fmt\\\":\\\"7.16%\\\"},\\\"sixMonthReturn\\\":{\\\"raw\\\":0.11739587,\\\"fmt\\\":\\\"11.74%\\\"},\\\"ytdReturnPct\\\":{\\\"raw\\\":0.14577454,\\\"fmt\\\":\\\"14.58%\\\"},\\\"oneYearTotalReturn\\\":{\\\"raw\\\":0.19268346,\\\"fmt\\\":\\\"19.27%\\\"},\\\"twoYearTotalReturn\\\":{\\\"raw\\\":0.34198746,\\\"fmt\\\":\\\"34.20%\\\"},\\\"threeYearTotalReturn\\\":{\\\"raw\\\":0.24189885,\\\"fmt\\\":\\\"24.19%\\\"},\\\"fiveYearTotalReturn\\\":{\\\"raw\\\":0.8061476,\\\"fmt\\\":\\\"80.61%\\\"},\\\"tenYearTotalReturn\\\":{\\\"raw\\\":1.7616969,\\\"fmt\\\":\\\"176.17%\\\"},\\\"maxReturn\\\":{\\\"raw\\\":41.290104,\\\"fmt\\\":\\\"4,129.01%\\\"}}},\\\"quoteUnadjustedPerformanceOverview\\\":{\\\"maxAge\\\":1,\\\"benchmark\\\":{\\\"symbol\\\":\\\"^GSPC\\\",\\\"shortName\\\":\\\"S&P 500\\\"},\\\"performanceOverview\\\":{\\\"asOfDate\\\":{\\\"raw\\\":1722211200,\\\"fmt\\\":\\\"2024-07-29\\\"},\\\"fiveDaysReturn\\\":{\\\"raw\\\":-0.025299162,\\\"fmt\\\":\\\"-2.53%\\\"},\\\"oneMonthReturn\\\":{\\\"raw\\\":0.03643534,\\\"fmt\\\":\\\"3.64%\\\"},\\\"threeMonthReturn\\\":{\\\"raw\\\":0.28939164,\\\"fmt\\\":\\\"28.94%\\\"},\\\"sixMonthReturn\\\":{\\\"raw\\\":0.13446632,\\\"fmt\\\":\\\"13.45%\\\"},\\\"ytdReturnPct\\\":{\\\"raw\\\":0.13381815,\\\"fmt\\\":\\\"13.38%\\\"},\\\"oneYearTotalReturn\\\":{\\\"raw\\\":0.11471176,\\\"fmt\\\":\\\"11.47%\\\"},\\\"twoYearTotalReturn\\\":{\\\"raw\\\":0.3873149,\\\"fmt\\\":\\\"38.73%\\\"},\\\"threeYearTotalReturn\\\":{\\\"raw\\\":0.50568366,\\\"fmt\\\":\\\"50.57%\\\"},\\\"fiveYearTotalReturn\\\":{\\\"raw\\\":3.2032156,\\\"fmt\\\":\\\"320.32%\\\"},\\\"tenYearTotalReturn\\\":{\\\"raw\\\":7.8181787,\\\"fmt\\\":\\\"781.82%\\\"},\\\"maxReturn\\\":{\\\"raw\\\":1699.798,\\\"fmt\\\":\\\"169,979.80%\\\"}},\\\"performanceOverviewBenchmark\\\":{\\\"asOfDate\\\":{\\\"raw\\\":1722211200,\\\"fmt\\\":\\\"2024-07-29\\\"},\\\"fiveDaysReturn\\\":{\\\"raw\\\":-0.017838415,\\\"fmt\\\":\\\"-1.78%\\\"},\\\"oneMonthReturn\\\":{\\\"raw\\\":8.552219E-4,\\\"fmt\\\":\\\"0.09%\\\"},\\\"threeMonthReturn\\\":{\\\"raw\\\":0.071606435,\\\"fmt\\\":\\\"7.16%\\\"},\\\"sixMonthReturn\\\":{\\\"raw\\\":0.11739587,\\\"fmt\\\":\\\"11.74%\\\"},\\\"ytdReturnPct\\\":{\\\"raw\\\":0.14577454,\\\"fmt\\\":\\\"14.58%\\\"},\\\"oneYearTotalReturn\\\":{\\\"raw\\\":0.19268346,\\\"fmt\\\":\\\"19.27%\\\"},\\\"twoYearTotalReturn\\\":{\\\"raw\\\":0.34198746,\\\"fmt\\\":\\\"34.20%\\\"},\\\"threeYearTotalReturn\\\":{\\\"raw\\\":0.24189885,\\\"fmt\\\":\\\"24.19%\\\"},\\\"fiveYearTotalReturn\\\":{\\\"raw\\\":0.8061476,\\\"fmt\\\":\\\"80.61%\\\"},\\\"tenYearTotalReturn\\\":{\\\"raw\\\":1.7616969,\\\"fmt\\\":\\\"176.17%\\\"},\\\"maxReturn\\\":{\\\"raw\\\":41.290104,\\\"fmt\\\":\\\"4,129.01%\\\"}}},\\\"esgScores\\\":{\\\"maxAge\\\":86400,\\\"totalEsg\\\":{\\\"raw\\\":17.22,\\\"fmt\\\":\\\"17.2\\\"},\\\"environmentScore\\\":{\\\"raw\\\":0.46,\\\"fmt\\\":\\\"0.5\\\"},\\\"socialScore\\\":{\\\"raw\\\":7.39,\\\"fmt\\\":\\\"7.4\\\"},\\\"governanceScore\\\":{\\\"raw\\\":9.37,\\\"fmt\\\":\\\"9.4\\\"},\\\"ratingYear\\\":2023,\\\"ratingMonth\\\":9,\\\"highestControversy\\\":3.0,\\\"peerCount\\\":55,\\\"esgPerformance\\\":\\\"UNDER_PERF\\\",\\\"peerGroup\\\":\\\"Technology Hardware\\\",\\\"relatedControversy\\\":[\\\"Social Supply Chain Incidents\\\",\\\"Customer Incidents\\\",\\\"Business Ethics Incidents\\\"],\\\"peerEsgScorePerformance\\\":{\\\"min\\\":6.37,\\\"avg\\\":15.565636363636367,\\\"max\\\":27.47},\\\"peerGovernancePerformance\\\":{\\\"min\\\":3.44,\\\"avg\\\":6.928431372549018,\\\"max\\\":11.13},\\\"peerSocialPerformance\\\":{\\\"min\\\":1.75,\\\"avg\\\":5.536862745098038,\\\"max\\\":9.76},\\\"peerEnvironmentPerformance\\\":{\\\"min\\\":0.11,\\\"avg\\\":3.0588235294117636,\\\"max\\\":9.54},\\\"peerHighestControversyPerformance\\\":{\\\"min\\\":0.0,\\\"avg\\\":1.5454545454545454,\\\"max\\\":4.0},\\\"percentile\\\":{\\\"raw\\\":17.82,\\\"fmt\\\":\\\"18\\\"},\\\"environmentPercentile\\\":null,\\\"socialPercentile\\\":null,\\\"governancePercentile\\\":null,\\\"adult\\\":false,\\\"alcoholic\\\":false,\\\"animalTesting\\\":false,\\\"catholic\\\":false,\\\"controversialWeapons\\\":false,\\\"smallArms\\\":false,\\\"furLeather\\\":false,\\\"gambling\\\":false,\\\"gmo\\\":false,\\\"militaryContract\\\":false,\\\"nuclear\\\":false,\\\"pesticides\\\":false,\\\"palmOil\\\":false,\\\"coal\\\":false,\\\"tobacco\\\":false},\\\"defaultKeyStatistics\\\":{\\\"maxAge\\\":1,\\\"priceHint\\\":{\\\"raw\\\":2,\\\"fmt\\\":\\\"2\\\",\\\"longFmt\\\":\\\"2\\\"},\\\"enterpriseValue\\\":{\\\"raw\\\":3379656392704,\\\"fmt\\\":\\\"3.38T\\\",\\\"longFmt\\\":\\\"3,379,656,392,704\\\"},\\\"forwardPE\\\":{\\\"raw\\\":32.33985,\\\"fmt\\\":\\\"32.34\\\"},\\\"profitMargins\\\":{\\\"raw\\\":0.26306,\\\"fmt\\\":\\\"26.31%\\\"},\\\"floatShares\\\":{\\\"raw\\\":15309394128,\\\"fmt\\\":\\\"15.31B\\\",\\\"longFmt\\\":\\\"15,309,394,128\\\"},\\\"sharesOutstanding\\\":{\\\"raw\\\":15334099968,\\\"fmt\\\":\\\"15.33B\\\",\\\"longFmt\\\":\\\"15,334,099,968\\\"},\\\"sharesShort\\\":{\\\"raw\\\":135383184,\\\"fmt\\\":\\\"135.38M\\\",\\\"longFmt\\\":\\\"135,383,184\\\"},\\\"sharesShortPriorMonth\\\":{\\\"raw\\\":153405579,\\\"fmt\\\":\\\"153.41M\\\",\\\"longFmt\\\":\\\"153,405,579\\\"},\\\"sharesShortPreviousMonthDate\\\":{\\\"raw\\\":1718323200,\\\"fmt\\\":\\\"2024-06-14\\\"},\\\"dateShortInterest\\\":{\\\"raw\\\":1721001600,\\\"fmt\\\":\\\"2024-07-15\\\"},\\\"sharesPercentSharesOut\\\":{\\\"raw\\\":0.0088,\\\"fmt\\\":\\\"0.88%\\\"},\\\"heldPercentInsiders\\\":{\\\"raw\\\":0.05219,\\\"fmt\\\":\\\"5.22%\\\"},\\\"heldPercentInstitutions\\\":{\\\"raw\\\":0.57601,\\\"fmt\\\":\\\"57.60%\\\"},\\\"shortRatio\\\":{\\\"raw\\\":1.83,\\\"fmt\\\":\\\"1.83\\\"},\\\"shortPercentOfFloat\\\":{\\\"raw\\\":0.0088,\\\"fmt\\\":\\\"0.88%\\\"},\\\"beta\\\":{\\\"raw\\\":1.244,\\\"fmt\\\":\\\"1.24\\\"},\\\"impliedSharesOutstanding\\\":{\\\"raw\\\":15410899968,\\\"fmt\\\":\\\"15.41B\\\",\\\"longFmt\\\":\\\"15,410,899,968\\\"},\\\"morningStarOverallRating\\\":{},\\\"morningStarRiskRating\\\":{},\\\"category\\\":null,\\\"bookValue\\\":{\\\"raw\\\":4.837,\\\"fmt\\\":\\\"4.84\\\"},\\\"priceToBook\\\":{\\\"raw\\\":45.130043,\\\"fmt\\\":\\\"45.13\\\"},\\\"annualReportExpenseRatio\\\":{},\\\"ytdReturn\\\":{},\\\"beta3Year\\\":{},\\\"totalAssets\\\":{},\\\"yield\\\":{},\\\"fundFamily\\\":null,\\\"fundInceptionDate\\\":{},\\\"legalType\\\":null,\\\"threeYearAverageReturn\\\":{},\\\"fiveYearAverageReturn\\\":{},\\\"priceToSalesTrailing12Months\\\":{},\\\"lastFiscalYearEnd\\\":{\\\"raw\\\":1696032000,\\\"fmt\\\":\\\"2023-09-30\\\"},\\\"nextFiscalYearEnd\\\":{\\\"raw\\\":1727654400,\\\"fmt\\\":\\\"2024-09-30\\\"},\\\"mostRecentQuarter\\\":{\\\"raw\\\":1711756800,\\\"fmt\\\":\\\"2024-03-30\\\"},\\\"earningsQuarterlyGrowth\\\":{\\\"raw\\\":-0.022,\\\"fmt\\\":\\\"-2.20%\\\"},\\\"revenueQuarterlyGrowth\\\":{},\\\"netIncomeToCommon\\\":{\\\"raw\\\":100389003264,\\\"fmt\\\":\\\"100.39B\\\",\\\"longFmt\\\":\\\"100,389,003,264\\\"},\\\"trailingEps\\\":{\\\"raw\\\":6.43,\\\"fmt\\\":\\\"6.43\\\"},\\\"forwardEps\\\":{\\\"raw\\\":6.75,\\\"fmt\\\":\\\"6.75\\\"},\\\"pegRatio\\\":{\\\"raw\\\":3.71,\\\"fmt\\\":\\\"3.71\\\"},\\\"lastSplitFactor\\\":\\\"4:1\\\",\\\"lastSplitDate\\\":{\\\"raw\\\":1598832000,\\\"fmt\\\":\\\"2020-08-31\\\"},\\\"enterpriseToRevenue\\\":{\\\"raw\\\":8.856,\\\"fmt\\\":\\\"8.86\\\"},\\\"enterpriseToEbitda\\\":{\\\"raw\\\":26.072,\\\"fmt\\\":\\\"26.07\\\"},\\\"52WeekChange\\\":{\\\"raw\\\":0.109493494,\\\"fmt\\\":\\\"10.95%\\\"},\\\"SandP52WeekChange\\\":{\\\"raw\\\":0.18961596,\\\"fmt\\\":\\\"18.96%\\\"},\\\"lastDividendValue\\\":{\\\"raw\\\":0.25,\\\"fmt\\\":\\\"0.25\\\"},\\\"lastDividendDate\\\":{\\\"raw\\\":1715299200,\\\"fmt\\\":\\\"2024-05-10\\\"},\\\"lastCapGain\\\":{},\\\"annualHoldingsTurnover\\\":{}},\\\"summaryProfile\\\":{\\\"address1\\\":\\\"One Apple Park Way\\\",\\\"city\\\":\\\"Cupertino\\\",\\\"state\\\":\\\"CA\\\",\\\"zip\\\":\\\"95014\\\",\\\"country\\\":\\\"United States\\\",\\\"phone\\\":\\\"408 996 1010\\\",\\\"website\\\":\\\"https://www.apple.com\\\",\\\"industry\\\":\\\"Consumer Electronics\\\",\\\"industryKey\\\":\\\"consumer-electronics\\\",\\\"industryDisp\\\":\\\"Consumer Electronics\\\",\\\"sector\\\":\\\"Technology\\\",\\\"sectorKey\\\":\\\"technology\\\",\\\"sectorDisp\\\":\\\"Technology\\\",\\\"longBusinessSummary\\\":\\\"Apple Inc. designs, manufactures, and markets smartphones, personal computers, tablets, wearables, and accessories worldwide. The company offers iPhone, a line of smartphones; Mac, a line of personal computers; iPad, a line of multi-purpose tablets; and wearables, home, and accessories comprising AirPods, Apple TV, Apple Watch, Beats products, and HomePod. It also provides AppleCare support and cloud services; and operates various platforms, including the App Store that allow customers to discover and download applications and digital content, such as books, music, video, games, and podcasts. In addition, the company offers various services, such as Apple Arcade, a game subscription service; Apple Fitness+, a personalized fitness service; Apple Music, which offers users a curated listening experience with on-demand radio stations; Apple News+, a subscription news and magazine service; Apple TV+, which offers exclusive original content; Apple Card, a co-branded credit card; and Apple Pay, a cashless payment service, as well as licenses its intellectual property. The company serves consumers, and small and mid-sized businesses; and the education, enterprise, and government markets. It distributes third-party applications for its products through the App Store. The company also sells its products through its retail and online stores, and direct sales force; and third-party cellular network carriers, wholesalers, retailers, and resellers. Apple Inc. was founded in 1976 and is headquartered in Cupertino, California.\\\",\\\"fullTimeEmployees\\\":150000,\\\"companyOfficers\\\":[],\\\"irWebsite\\\":\\\"http://investor.apple.com/\\\",\\\"maxAge\\\":86400},\\\"financialsTemplate\\\":{\\\"code\\\":\\\"N\\\",\\\"maxAge\\\":1},\\\"summaryDetail\\\":{\\\"maxAge\\\":1,\\\"priceHint\\\":{\\\"raw\\\":2,\\\"fmt\\\":\\\"2\\\",\\\"longFmt\\\":\\\"2\\\"},\\\"previousClose\\\":{\\\"raw\\\":217.96,\\\"fmt\\\":\\\"217.96\\\"},\\\"open\\\":{\\\"raw\\\":217.002,\\\"fmt\\\":\\\"217.00\\\"},\\\"dayLow\\\":{\\\"raw\\\":215.76,\\\"fmt\\\":\\\"215.76\\\"},\\\"dayHigh\\\":{\\\"raw\\\":219.3,\\\"fmt\\\":\\\"219.30\\\"},\\\"regularMarketPreviousClose\\\":{\\\"raw\\\":217.96,\\\"fmt\\\":\\\"217.96\\\"},\\\"regularMarketOpen\\\":{\\\"raw\\\":217.002,\\\"fmt\\\":\\\"217.00\\\"},\\\"regularMarketDayLow\\\":{\\\"raw\\\":215.76,\\\"fmt\\\":\\\"215.76\\\"},\\\"regularMarketDayHigh\\\":{\\\"raw\\\":219.3,\\\"fmt\\\":\\\"219.30\\\"},\\\"dividendRate\\\":{\\\"raw\\\":1.0,\\\"fmt\\\":\\\"1.00\\\"},\\\"dividendYield\\\":{\\\"raw\\\":0.0046,\\\"fmt\\\":\\\"0.46%\\\"},\\\"exDividendDate\\\":{\\\"raw\\\":1715299200,\\\"fmt\\\":\\\"2024-05-10\\\"},\\\"payoutRatio\\\":{\\\"raw\\\":0.14930001,\\\"fmt\\\":\\\"14.93%\\\"},\\\"fiveYearAvgDividendYield\\\":{\\\"raw\\\":0.69,\\\"fmt\\\":\\\"0.69\\\"},\\\"beta\\\":{\\\"raw\\\":1.244,\\\"fmt\\\":\\\"1.24\\\"},\\\"trailingPE\\\":{\\\"raw\\\":33.949303,\\\"fmt\\\":\\\"33.95\\\"},\\\"forwardPE\\\":{\\\"raw\\\":32.33985,\\\"fmt\\\":\\\"32.34\\\"},\\\"volume\\\":{\\\"raw\\\":29578111,\\\"fmt\\\":\\\"29.58M\\\",\\\"longFmt\\\":\\\"29,578,111\\\"},\\\"regularMarketVolume\\\":{\\\"raw\\\":29578111,\\\"fmt\\\":\\\"29.58M\\\",\\\"longFmt\\\":\\\"29,578,111\\\"},\\\"averageVolume\\\":{\\\"raw\\\":68058093,\\\"fmt\\\":\\\"68.06M\\\",\\\"longFmt\\\":\\\"68,058,093\\\"},\\\"averageVolume10days\\\":{\\\"raw\\\":52130860,\\\"fmt\\\":\\\"52.13M\\\",\\\"longFmt\\\":\\\"52,130,860\\\"},\\\"averageDailyVolume10Day\\\":{\\\"raw\\\":52130860,\\\"fmt\\\":\\\"52.13M\\\",\\\"longFmt\\\":\\\"52,130,860\\\"},\\\"bid\\\":{\\\"raw\\\":218.22,\\\"fmt\\\":\\\"218.22\\\"},\\\"ask\\\":{\\\"raw\\\":218.36,\\\"fmt\\\":\\\"218.36\\\"},\\\"bidSize\\\":{\\\"raw\\\":100,\\\"fmt\\\":\\\"100\\\",\\\"longFmt\\\":\\\"100\\\"},\\\"askSize\\\":{\\\"raw\\\":100,\\\"fmt\\\":\\\"100\\\",\\\"longFmt\\\":\\\"100\\\"},\\\"marketCap\\\":{\\\"raw\\\":3347342163968,\\\"fmt\\\":\\\"3.35T\\\",\\\"longFmt\\\":\\\"3,347,342,163,968\\\"},\\\"yield\\\":{},\\\"ytdReturn\\\":{},\\\"totalAssets\\\":{},\\\"expireDate\\\":{},\\\"strikePrice\\\":{},\\\"openInterest\\\":{},\\\"fiftyTwoWeekLow\\\":{\\\"raw\\\":164.08,\\\"fmt\\\":\\\"164.08\\\"},\\\"fiftyTwoWeekHigh\\\":{\\\"raw\\\":237.23,\\\"fmt\\\":\\\"237.23\\\"},\\\"priceToSalesTrailing12Months\\\":{\\\"raw\\\":8.771332,\\\"fmt\\\":\\\"8.77\\\"},\\\"fiftyDayAverage\\\":{\\\"raw\\\":209.709,\\\"fmt\\\":\\\"209.71\\\"},\\\"twoHundredDayAverage\\\":{\\\"raw\\\":188.5172,\\\"fmt\\\":\\\"188.52\\\"},\\\"trailingAnnualDividendRate\\\":{\\\"raw\\\":0.96,\\\"fmt\\\":\\\"0.96\\\"},\\\"trailingAnnualDividendYield\\\":{\\\"raw\\\":0.004404478,\\\"fmt\\\":\\\"0.44%\\\"},\\\"navPrice\\\":{},\\\"currency\\\":\\\"USD\\\",\\\"fromCurrency\\\":null,\\\"toCurrency\\\":null,\\\"lastMarket\\\":null,\\\"coinMarketCapLink\\\":null,\\\"volume24Hr\\\":{},\\\"volumeAllCurrencies\\\":{},\\\"circulatingSupply\\\":{},\\\"algorithm\\\":null,\\\"maxSupply\\\":{},\\\"startDate\\\":{},\\\"tradeable\\\":false},\\\"earnings\\\":{\\\"maxAge\\\":86400,\\\"earningsChart\\\":{\\\"quarterly\\\":[{\\\"date\\\":\\\"2Q2023\\\",\\\"actual\\\":{\\\"raw\\\":1.18,\\\"fmt\\\":\\\"1.18\\\"},\\\"estimate\\\":{\\\"raw\\\":1.12,\\\"fmt\\\":\\\"1.12\\\"}},{\\\"date\\\":\\\"3Q2023\\\",\\\"actual\\\":{\\\"raw\\\":1.36,\\\"fmt\\\":\\\"1.36\\\"},\\\"estimate\\\":{\\\"raw\\\":1.3,\\\"fmt\\\":\\\"1.30\\\"}},{\\\"date\\\":\\\"4Q2023\\\",\\\"actual\\\":{\\\"raw\\\":2.04,\\\"fmt\\\":\\\"2.04\\\"},\\\"estimate\\\":{\\\"raw\\\":1.96,\\\"fmt\\\":\\\"1.96\\\"}},{\\\"date\\\":\\\"1Q2024\\\",\\\"actual\\\":{\\\"raw\\\":1.53,\\\"fmt\\\":\\\"1.53\\\"},\\\"estimate\\\":{\\\"raw\\\":1.5,\\\"fmt\\\":\\\"1.50\\\"}}],\\\"currentQuarterEstimate\\\":{\\\"raw\\\":1.23,\\\"fmt\\\":\\\"1.23\\\"},\\\"currentQuarterEstimateDate\\\":\\\"2Q\\\",\\\"currentQuarterEstimateYear\\\":2024,\\\"earningsDate\\\":[{\\\"raw\\\":1722542400,\\\"fmt\\\":\\\"2024-08-01\\\"}],\\\"isEarningsDateEstimate\\\":false},\\\"financialsChart\\\":{\\\"yearly\\\":[{\\\"date\\\":2020,\\\"revenue\\\":{\\\"raw\\\":274515000000,\\\"fmt\\\":\\\"274.51B\\\",\\\"longFmt\\\":\\\"274,515,000,000\\\"},\\\"earnings\\\":{\\\"raw\\\":57411000000,\\\"fmt\\\":\\\"57.41B\\\",\\\"longFmt\\\":\\\"57,411,000,000\\\"}},{\\\"date\\\":2021,\\\"revenue\\\":{\\\"raw\\\":365817000000,\\\"fmt\\\":\\\"365.82B\\\",\\\"longFmt\\\":\\\"365,817,000,000\\\"},\\\"earnings\\\":{\\\"raw\\\":94680000000,\\\"fmt\\\":\\\"94.68B\\\",\\\"longFmt\\\":\\\"94,680,000,000\\\"}},{\\\"date\\\":2022,\\\"revenue\\\":{\\\"raw\\\":394328000000,\\\"fmt\\\":\\\"394.33B\\\",\\\"longFmt\\\":\\\"394,328,000,000\\\"},\\\"earnings\\\":{\\\"raw\\\":99803000000,\\\"fmt\\\":\\\"99.8B\\\",\\\"longFmt\\\":\\\"99,803,000,000\\\"}},{\\\"date\\\":2023,\\\"revenue\\\":{\\\"raw\\\":383285000000,\\\"fmt\\\":\\\"383.29B\\\",\\\"longFmt\\\":\\\"383,285,000,000\\\"},\\\"earnings\\\":{\\\"raw\\\":96995000000,\\\"fmt\\\":\\\"97B\\\",\\\"longFmt\\\":\\\"96,995,000,000\\\"}}],\\\"quarterly\\\":[{\\\"date\\\":\\\"2Q2023\\\",\\\"revenue\\\":{\\\"raw\\\":81797000000,\\\"fmt\\\":\\\"81.8B\\\",\\\"longFmt\\\":\\\"81,797,000,000\\\"},\\\"earnings\\\":{\\\"raw\\\":19881000000,\\\"fmt\\\":\\\"19.88B\\\",\\\"longFmt\\\":\\\"19,881,000,000\\\"}},{\\\"date\\\":\\\"3Q2023\\\",\\\"revenue\\\":{\\\"raw\\\":89498000000,\\\"fmt\\\":\\\"89.5B\\\",\\\"longFmt\\\":\\\"89,498,000,000\\\"},\\\"earnings\\\":{\\\"raw\\\":22956000000,\\\"fmt\\\":\\\"22.96B\\\",\\\"longFmt\\\":\\\"22,956,000,000\\\"}},{\\\"date\\\":\\\"4Q2023\\\",\\\"revenue\\\":{\\\"raw\\\":119575000000,\\\"fmt\\\":\\\"119.58B\\\",\\\"longFmt\\\":\\\"119,575,000,000\\\"},\\\"earnings\\\":{\\\"raw\\\":33916000000,\\\"fmt\\\":\\\"33.92B\\\",\\\"longFmt\\\":\\\"33,916,000,000\\\"}},{\\\"date\\\":\\\"1Q2024\\\",\\\"revenue\\\":{\\\"raw\\\":90753000000,\\\"fmt\\\":\\\"90.75B\\\",\\\"longFmt\\\":\\\"90,753,000,000\\\"},\\\"earnings\\\":{\\\"raw\\\":23636000000,\\\"fmt\\\":\\\"23.64B\\\",\\\"longFmt\\\":\\\"23,636,000,000\\\"}}]},\\\"financialCurrency\\\":\\\"USD\\\"},\\\"calendarEvents\\\":{\\\"maxAge\\\":1,\\\"earnings\\\":{\\\"earningsDate\\\":[{\\\"raw\\\":1722542400,\\\"fmt\\\":\\\"2024-08-01\\\"}],\\\"earningsCallDate\\\":[{\\\"raw\\\":1714683600,\\\"fmt\\\":\\\"2024-05-02\\\"}],\\\"isEarningsDateEstimate\\\":false,\\\"earningsAverage\\\":{\\\"raw\\\":1.23,\\\"fmt\\\":\\\"1.23\\\"},\\\"earningsLow\\\":{\\\"raw\\\":1.19,\\\"fmt\\\":\\\"1.19\\\"},\\\"earningsHigh\\\":{\\\"raw\\\":1.33,\\\"fmt\\\":\\\"1.33\\\"},\\\"revenueAverage\\\":{\\\"raw\\\":77573200000,\\\"fmt\\\":\\\"77.57B\\\",\\\"longFmt\\\":\\\"77,573,200,000\\\"},\\\"revenueLow\\\":{\\\"raw\\\":76251100000,\\\"fmt\\\":\\\"76.25B\\\",\\\"longFmt\\\":\\\"76,251,100,000\\\"},\\\"revenueHigh\\\":{\\\"raw\\\":81723600000,\\\"fmt\\\":\\\"81.72B\\\",\\\"longFmt\\\":\\\"81,723,600,000\\\"}},\\\"exDividendDate\\\":{\\\"raw\\\":1715299200,\\\"fmt\\\":\\\"2024-05-10\\\"},\\\"dividendDate\\\":{\\\"raw\\\":1715817600,\\\"fmt\\\":\\\"2024-05-16\\\"}},\\\"pageViews\\\":{\\\"shortTermTrend\\\":\\\"UP\\\",\\\"midTermTrend\\\":\\\"UP\\\",\\\"longTermTrend\\\":\\\"UP\\\",\\\"maxAge\\\":1},\\\"price\\\":{\\\"maxAge\\\":1,\\\"preMarketChangePercent\\\":{\\\"raw\\\":-0.0047257002,\\\"fmt\\\":\\\"-0.47%\\\"},\\\"preMarketChange\\\":{\\\"raw\\\":-1.03001,\\\"fmt\\\":\\\"-1.03\\\"},\\\"preMarketTime\\\":1722259799,\\\"preMarketPrice\\\":{\\\"raw\\\":216.93,\\\"fmt\\\":\\\"216.93\\\"},\\\"preMarketSource\\\":\\\"FREE_REALTIME\\\",\\\"postMarketChange\\\":{},\\\"postMarketPrice\\\":{},\\\"regularMarketChangePercent\\\":{\\\"raw\\\":0.0015323895,\\\"fmt\\\":\\\"0.15%\\\"},\\\"regularMarketChange\\\":{\\\"raw\\\":0.33399963,\\\"fmt\\\":\\\"0.33\\\"},\\\"regularMarketTime\\\":1722283009,\\\"priceHint\\\":{\\\"raw\\\":2,\\\"fmt\\\":\\\"2\\\",\\\"longFmt\\\":\\\"2\\\"},\\\"regularMarketPrice\\\":{\\\"raw\\\":218.294,\\\"fmt\\\":\\\"218.29\\\"},\\\"regularMarketDayHigh\\\":{\\\"raw\\\":219.3,\\\"fmt\\\":\\\"219.30\\\"},\\\"regularMarketDayLow\\\":{\\\"raw\\\":215.76,\\\"fmt\\\":\\\"215.76\\\"},\\\"regularMarketVolume\\\":{\\\"raw\\\":29578111,\\\"fmt\\\":\\\"29.58M\\\",\\\"longFmt\\\":\\\"29,578,111.00\\\"},\\\"averageDailyVolume10Day\\\":{\\\"raw\\\":52130860,\\\"fmt\\\":\\\"52.13M\\\",\\\"longFmt\\\":\\\"52,130,860\\\"},\\\"averageDailyVolume3Month\\\":{\\\"raw\\\":68058093,\\\"fmt\\\":\\\"68.06M\\\",\\\"longFmt\\\":\\\"68,058,093\\\"},\\\"regularMarketPreviousClose\\\":{\\\"raw\\\":217.96,\\\"fmt\\\":\\\"217.96\\\"},\\\"regularMarketSource\\\":\\\"FREE_REALTIME\\\",\\\"regularMarketOpen\\\":{\\\"raw\\\":217.002,\\\"fmt\\\":\\\"217.00\\\"},\\\"strikePrice\\\":{},\\\"openInterest\\\":{},\\\"exchange\\\":\\\"NMS\\\",\\\"exchangeName\\\":\\\"NasdaqGS\\\",\\\"exchangeDataDelayedBy\\\":0,\\\"marketState\\\":\\\"REGULAR\\\",\\\"quoteType\\\":\\\"EQUITY\\\",\\\"symbol\\\":\\\"AAPL\\\",\\\"underlyingSymbol\\\":null,\\\"shortName\\\":\\\"Apple Inc.\\\",\\\"longName\\\":\\\"Apple Inc.\\\",\\\"currency\\\":\\\"USD\\\",\\\"quoteSourceName\\\":\\\"Nasdaq Real Time Price\\\",\\\"currencySymbol\\\":\\\"$\\\",\\\"fromCurrency\\\":null,\\\"toCurrency\\\":null,\\\"lastMarket\\\":null,\\\"volume24Hr\\\":{},\\\"volumeAllCurrencies\\\":{},\\\"circulatingSupply\\\":{},\\\"marketCap\\\":{\\\"raw\\\":3347342163968,\\\"fmt\\\":\\\"3.35T\\\",\\\"longFmt\\\":\\\"3,347,342,163,968.00\\\"}},\\\"financialData\\\":{\\\"maxAge\\\":86400,\\\"currentPrice\\\":{\\\"raw\\\":218.294,\\\"fmt\\\":\\\"218.29\\\"},\\\"targetHighPrice\\\":{\\\"raw\\\":275.88,\\\"fmt\\\":\\\"275.88\\\"},\\\"targetLowPrice\\\":{\\\"raw\\\":156.33,\\\"fmt\\\":\\\"156.33\\\"},\\\"targetMeanPrice\\\":{\\\"raw\\\":207.89,\\\"fmt\\\":\\\"207.89\\\"},\\\"targetMedianPrice\\\":{\\\"raw\\\":202.31,\\\"fmt\\\":\\\"202.31\\\"},\\\"recommendationMean\\\":{\\\"raw\\\":2.0,\\\"fmt\\\":\\\"2.00\\\"},\\\"recommendationKey\\\":\\\"buy\\\",\\\"numberOfAnalystOpinions\\\":{\\\"raw\\\":37,\\\"fmt\\\":\\\"37\\\",\\\"longFmt\\\":\\\"37\\\"},\\\"totalCash\\\":{\\\"raw\\\":67150000128,\\\"fmt\\\":\\\"67.15B\\\",\\\"longFmt\\\":\\\"67,150,000,128\\\"},\\\"totalCashPerShare\\\":{\\\"raw\\\":4.379,\\\"fmt\\\":\\\"4.38\\\"},\\\"ebitda\\\":{\\\"raw\\\":129629003776,\\\"fmt\\\":\\\"129.63B\\\",\\\"longFmt\\\":\\\"129,629,003,776\\\"},\\\"totalDebt\\\":{\\\"raw\\\":104590000128,\\\"fmt\\\":\\\"104.59B\\\",\\\"longFmt\\\":\\\"104,590,000,128\\\"},\\\"quickRatio\\\":{\\\"raw\\\":0.875,\\\"fmt\\\":\\\"0.88\\\"},\\\"currentRatio\\\":{\\\"raw\\\":1.037,\\\"fmt\\\":\\\"1.04\\\"},\\\"totalRevenue\\\":{\\\"raw\\\":381623009280,\\\"fmt\\\":\\\"381.62B\\\",\\\"longFmt\\\":\\\"381,623,009,280\\\"},\\\"debtToEquity\\\":{\\\"raw\\\":140.968,\\\"fmt\\\":\\\"140.97%\\\"},\\\"revenuePerShare\\\":{\\\"raw\\\":24.537,\\\"fmt\\\":\\\"24.54\\\"},\\\"returnOnAssets\\\":{\\\"raw\\\":0.22073999,\\\"fmt\\\":\\\"22.07%\\\"},\\\"returnOnEquity\\\":{\\\"raw\\\":1.4725,\\\"fmt\\\":\\\"147.25%\\\"},\\\"grossProfits\\\":{},\\\"freeCashflow\\\":{\\\"raw\\\":84726874112,\\\"fmt\\\":\\\"84.73B\\\",\\\"longFmt\\\":\\\"84,726,874,112\\\"},\\\"operatingCashflow\\\":{\\\"raw\\\":110563000320,\\\"fmt\\\":\\\"110.56B\\\",\\\"longFmt\\\":\\\"110,563,000,320\\\"},\\\"earningsGrowth\\\":{\\\"raw\\\":0.007,\\\"fmt\\\":\\\"0.70%\\\"},\\\"revenueGrowth\\\":{\\\"raw\\\":-0.043,\\\"fmt\\\":\\\"-4.30%\\\"},\\\"grossMargins\\\":{\\\"raw\\\":0.45586,\\\"fmt\\\":\\\"45.59%\\\"},\\\"ebitdaMargins\\\":{\\\"raw\\\":0.33968,\\\"fmt\\\":\\\"33.97%\\\"},\\\"operatingMargins\\\":{\\\"raw\\\":0.30743,\\\"fmt\\\":\\\"30.74%\\\"},\\\"profitMargins\\\":{\\\"raw\\\":0.26306,\\\"fmt\\\":\\\"26.31%\\\"},\\\"financialCurrency\\\":\\\"USD\\\"}}],\\\"error\\\":null}}\"}\n";

        try {
            Stock stock = StockMapper.buildStockFromJson(optionsJsonStr, searchJsonStr, quoteJson, "yyyy-MM-dd");
            assertNotNull(stock);

            // Assert stock fields
            assertEquals("AAPL", stock.getSymbol());
            assertEquals("Apple Inc.", stock.getName());
            assertEquals("EQUITY", stock.getType());
            assertEquals("Technology", stock.getSector());
            assertEquals("Consumer Electronics", stock.getIndustry());
            assertEquals("NASDAQ", stock.getExchange());
            assertEquals("USD", stock.getCurrency());
            assertEquals("America/New_York", stock.getExchangeTimezone());
            assertEquals(68492950, stock.getAverageDailyVolume3Month());
            assertEquals(53271200, stock.getAverageDailyVolume10Day());
            assertEquals(221.55, stock.getRegularMarketPrice());
            assertEquals(0.0706917, stock.getRegularMarketChangePercent());
            assertEquals(3397269848064L, stock.getMarketCap());
            assertEquals(52.677597, stock.getFiftyTwoWeekLowChange());
            assertEquals(0.32104826, stock.getFiftyTwoWeekLowChangePercent());
            assertEquals("164.08 - 237.23", stock.getFiftyTwoWeekRange());
            assertEquals(-20.472397, stock.getFiftyTwoWeekHighChange());
            assertEquals(-0.086297676, stock.getFiftyTwoWeekHighChangePercent());
            assertEquals(164.08, stock.getFiftyTwoWeekLow());
            assertEquals(237.23, stock.getFiftyTwoWeekHigh());
            assertEquals(4.837, stock.getBookValue());
            assertEquals(46.79347, stock.getPriceToBook());
            assertEquals(34.455677, stock.getTrailingPE());
            assertEquals(30.349316, stock.getForwardPE());
            assertEquals(7.3, stock.getEpsTrailingTwelveMonths());
            assertEquals(6.6, stock.getEpsCurrentYear());
            assertEquals(7.3, stock.getEpsForward());
            assertEquals(34.293938, stock.getPriceEpsCurrentYear());
            assertEquals(TimestampConverter.convertTimestampToDate(1715817600L, "yyyy-MM-dd"), stock.getDividendDate());
            assertEquals(6.43, stock.getTrailingAnnualDividendRate());
            assertEquals(0.0043582874, stock.getTrailingAnnualDividendYield());
            assertEquals(TimestampConverter.convertTimestampToDate(1714681800L, "yyyy-MM-dd"), stock.getEarningsTimestamp());
            assertEquals(15334099968L, stock.getSharesOutstanding());

        } catch (IOException e) {
            fail("Exception should not be thrown");
        }
    }

}